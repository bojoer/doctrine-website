<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>

<meta name="generator" content="PHPDoctor 2RC4 (http://phpdoctor.sourceforge.net/)">
<meta name="when" content="Fri, 09 Apr 2010 11:50:25 -0400">

<link rel="stylesheet" type="text/css" href="../stylesheet.css">
<link rel="start" href="../overview-summary.html">

<title>Doctrine_Query_Tokenizer (Doctrine 1.2 ORM)</title>

</head>
<body id="definition" onload="parent.document.title=document.title;">

<div class="header">
<h1>Doctrine</h1>
<ul>
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="../doctrine/package-summary.html">Namespace</a></li>
<li class="active">Class</li>
<li><a href="../doctrine/package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../index.html" target="_top">Frames</a>
<a href="../doctrine/doctrine_query_tokenizer.html" target="_top">No frames</a>
</div>
<div class="small_links">
Summary: <a href="#summary_field">Field</a> | <a href="#summary_method">Method</a> | <a href="#summary_constr">Constr</a>
Detail: <a href="#detail_field">Field</a> | <a href="#detail_method">Method</a> | <a href="#summary_constr">Constr</a>
</div>
<hr>

<div class="qualifiedName">Doctrine\Doctrine_Query_Tokenizer</div>
<div class="location">/Doctrine/Query/Tokenizer.php at line 35</div>

<h1>Class Doctrine_Query_Tokenizer</h1>

<pre class="tree"><strong>Doctrine_Query_Tokenizer</strong><br /></pre>

<hr>

<p class="signature">public  class <strong>Doctrine_Query_Tokenizer</strong></p>

<div class="comment" id="overview_description"><p>Doctrine_Query_Tokenizer</p></div>

<dl>
<dt>Subpackage:</dt>
<dd>Query</dd>
<dt>License:</dt>
<dd>http://www.opensource.org/licenses/lgpl-license.php LGPL</dd>
<dt>See Also:</dt>
<dd><code>www.doctrine-project.org</code></dd>
<dt>Since:</dt>
<dd>1.0</dd>
<dt>Version:</dt>
<dd>$Revision$</dd>
<dt>Author:</dt>
<dd>Konsta Vesterinen <kvesteri@cc.hut.fi></dd>
<dd>Guilherme Blanco <guilhermeblanco@hotmail.com></dd>
<dd>Stefan Klug <stefan.klug@googlemail.com></dd>
</dl>
<hr>

<table id="summary_method">
<tr><th colspan="2">Method Summary</th></tr>
<tr>
<td class="type"> array</td>
<td class="description"><p class="name"><a href="#bracketExplode()">bracketExplode</a>(string str, string d, string e1, string e2)</p><p class="description">Explodes a sql expression respecting bracket placement.
</p></td>
</tr>
<tr>
<td class="type"> string</td>
<td class="description"><p class="name"><a href="#bracketTrim()">bracketTrim</a>(string str, string e1, string e2)</p><p class="description">Trims brackets from string.</p></td>
</tr>
<tr>
<td class="type"> array</td>
<td class="description"><p class="name"><a href="#clauseExplode()">clauseExplode</a>(string str, string d, string e1, string e2)</p><p class="description">Explodes a string into array using custom brackets and quote delimeters
Each array element is a array of length 2 where the first entry contains
the term, and the second entry contains the corresponding delimiter.</p></td>
</tr>
<tr>
<td class="type">private  unknown_type</td>
<td class="description"><p class="name"><a href="#clauseExplodeCountBrackets()">clauseExplodeCountBrackets</a>(mixed str, mixed regexp, mixed e1, mixed e2, $e2 )</p><p class="description">this function is like clauseExplode, but it doesn't merge bracket terms.</p></td>
</tr>
<tr>
<td class="type">private  array</td>
<td class="description"><p class="name"><a href="#clauseExplodeNonQuoted()">clauseExplodeNonQuoted</a>(mixed str, mixed regexp, $e2 )</p><p class="description">Explodes a string by the given delimiters, and counts quotes in every
term. </p></td>
</tr>
<tr>
<td class="type">private  array</td>
<td class="description"><p class="name"><a href="#clauseExplodeRegExp()">clauseExplodeRegExp</a>(mixed str, mixed regexp, mixed e1, mixed e2, $e2 )</p><p class="description">Same as clauseExplode, but you give a regexp, which splits the string.</p></td>
</tr>
<tr>
<td class="type">private  string</td>
<td class="description"><p class="name"><a href="#getSplitRegExpFromArray()">getSplitRegExpFromArray</a>(mixed d, $d )</p><p class="description">Builds regular expression for split from array. </p></td>
</tr>
<tr>
<td class="type">private  array</td>
<td class="description"><p class="name"><a href="#mergeBracketTerms()">mergeBracketTerms</a>(mixed terms, $terms array)</p><p class="description">This expects input from clauseExplodeNonQuoted.
</p></td>
</tr>
<tr>
<td class="type"> array</td>
<td class="description"><p class="name"><a href="#quoteExplode()">quoteExplode</a>(string str, string d)</p><p class="description">Explode quotes from string.</p></td>
</tr>
<tr>
<td class="type"> array</td>
<td class="description"><p class="name"><a href="#quotedStringExplode()">quotedStringExplode</a>(mixed str, $str the)</p><p class="description">Explodes the given string by .</p></td>
</tr>
<tr>
<td class="type"> array</td>
<td class="description"><p class="name"><a href="#sqlExplode()">sqlExplode</a>(string str, string d, string e1, string e2)</p><p class="description">Explodes a string into array using custom brackets and
quote delimeters.</p></td>
</tr>
<tr>
<td class="type"> array</td>
<td class="description"><p class="name"><a href="#tokenizeQuery()">tokenizeQuery</a>(string query)</p><p class="description">Splits the given dql query into an array where keys represent different
query part names and values are arrays splitted using sqlExplode method.</p></td>
</tr>
</table>

<h2 id="detail_method">Method Detail</h2>
<div class="location">/Doctrine/Query/Tokenizer.php at line 152</div>
<h3 id="bracketExplode()">bracketExplode</h3>
<code class="signature">public  array <strong>bracketExplode</strong>(string str, string d, string e1, string e2)</code>
<div class="details">
<p>Explodes a sql expression respecting bracket placement.</p><p>This method transform a sql expression in an array of simple clauses,
while observing the parentheses precedence.</p><p>Note: bracketExplode always trims the returned pieces</p><p><code>
$str = (age < 20 AND age > 18) AND email LIKE 'John@example.com'
$clauses = $tokenizer->bracketExplode($str, ' AND ', '(', ')');
array("(age < 20 AND age > 18)", "email LIKE 'John@example.com'")
</code></p><dl>
<dt>Parameters:</dt>
<dd>str - String to be bracket exploded</dd>
<dd>d - Delimeter which explodes the string</dd>
<dd>e1 - First bracket, usually '('</dd>
<dd>e2 - Second bracket, usually ')'</dd>
</dl>
</div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 122</div>
<h3 id="bracketTrim()">bracketTrim</h3>
<code class="signature">public  string <strong>bracketTrim</strong>(string str, string e1, string e2)</code>
<div class="details">
<p>Trims brackets from string</p><dl>
<dt>Parameters:</dt>
<dd>str - String to remove the brackets</dd>
<dd>e1 - First bracket, usually '('</dd>
<dd>e2 - Second bracket, usually ')'</dd>
</dl>
</div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 285</div>
<h3 id="clauseExplode()">clauseExplode</h3>
<code class="signature">public  array <strong>clauseExplode</strong>(string str, string d, string e1, string e2)</code>
<div class="details">
<p>Explodes a string into array using custom brackets and quote delimeters
Each array element is a array of length 2 where the first entry contains
the term, and the second entry contains the corresponding delimiter</p><p>example:</p><p>parameters:
$str = "(age < 20 AND age > 18) AND name LIKE 'John'+' Doe'"
$d   = array(' ', '+')
$e1  = '('
$e2  = ')'</p><p>would return an array:
array(
array('(age < 20 AND age > 18)', ' '),
array('AND',  ' '),
array('name', ' '),
array('LIKE', ' '),
array('John', '+'),
array(' Doe', '')
);</p><dl>
<dt>Parameters:</dt>
<dd>str - String to be clause exploded</dd>
<dd>d - Delimeter which explodes the string</dd>
<dd>e1 - First bracket, usually '('</dd>
<dd>e2 - Second bracket, usually ')'</dd>
</dl>
</div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 350</div>
<h3 id="clauseExplodeCountBrackets()">clauseExplodeCountBrackets</h3>
<code class="signature">private  unknown_type <strong>clauseExplodeCountBrackets</strong>(mixed str, mixed regexp, mixed e1, mixed e2, $e2 )</code>
<div class="details">
<p>this function is like clauseExplode, but it doesn't merge bracket terms</p></div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 425</div>
<h3 id="clauseExplodeNonQuoted()">clauseExplodeNonQuoted</h3>
<code class="signature">private  array <strong>clauseExplodeNonQuoted</strong>(mixed str, mixed regexp, $e2 )</code>
<div class="details">
<p>Explodes a string by the given delimiters, and counts quotes in every
term. This function doesn't respect quoted strings.
The returned array contains a array per term. These term array contain
the following elemnts:
[0] = the term itself
[1] = the delimiter splitting this term from the next
[2] = the sum of opening and closing brackets in this term
(eg. -2 means 2 closing brackets (or 1 opening and 3 closing))</p><p>example:</p><p>parameters:
$str = "a (b '(c+d))'"
$d = array(' ', '+')</p><p>returns:
array(
array('a', ' ', 0),
array('(b', ' ', 1),
array("'(c", '+', 1),
array("d))'", '', -2)
);</p></div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 327</div>
<h3 id="clauseExplodeRegExp()">clauseExplodeRegExp</h3>
<code class="signature">private  array <strong>clauseExplodeRegExp</strong>(mixed str, mixed regexp, mixed e1, mixed e2, $e2 )</code>
<div class="details">
<p>Same as clauseExplode, but you give a regexp, which splits the string</p></div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 300</div>
<h3 id="getSplitRegExpFromArray()">getSplitRegExpFromArray</h3>
<code class="signature">private  string <strong>getSplitRegExpFromArray</strong>(mixed d, $d )</code>
<div class="details">
<p>Builds regular expression for split from array. Return regular
expression to be applied</p></div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 472</div>
<h3 id="mergeBracketTerms()">mergeBracketTerms</h3>
<code class="signature">private  array <strong>mergeBracketTerms</strong>(mixed terms, $terms array)</code>
<div class="details">
<p>This expects input from clauseExplodeNonQuoted.
It will go through the result and merges any bracket terms with 
unbalanced bracket count.
Note that only the third parameter in each term is used to get the 
bracket overhang. This is needed to be able to handle quoted strings
wich contain brackets</p><p>example:</p><p>parameters:
$terms = array(
array("'a(b'", '+', 0)
array('(2', '+', 1),
array('3)', '-', -1),
array('5', '' , '0')
);</p><p>would return:
array(
array("'a(b'", '+', 0),
array('(2+3)', '-', 0),
array('5'    , '' , 0)
);</p></div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 191</div>
<h3 id="quoteExplode()">quoteExplode</h3>
<code class="signature">public  array <strong>quoteExplode</strong>(string str, string d)</code>
<div class="details">
<p>Explode quotes from string</p><p>Note: quoteExplode always trims the returned pieces</p><p>example:</p><p>parameters:
$str = email LIKE 'John@example.com'
$d = ' LIKE '</p><p>would return an array:
array("email", "LIKE", "'John@example.com'")</p><dl>
<dt>Parameters:</dt>
<dd>str - String to be quote exploded</dd>
<dd>d - Delimeter which explodes the string</dd>
</dl>
</div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 513</div>
<h3 id="quotedStringExplode()">quotedStringExplode</h3>
<code class="signature">public  array <strong>quotedStringExplode</strong>(mixed str, $str the)</code>
<div class="details">
<p>Explodes the given string by <quoted words></p><p>example:</p><p>paramters:
$str ="'a' AND name = 'John O\'Connor'"</p><p>returns
array("", "'a'", " AND name = ", "'John O\'Connor'")</p><p>Note the trailing empty string. In the result, all even elements are quoted strings.</p><dl>
<dt>Parameters:</dt>
<dd>the - string to split</dd>
</dl>
</div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 239</div>
<h3 id="sqlExplode()">sqlExplode</h3>
<code class="signature">public  array <strong>sqlExplode</strong>(string str, string d, string e1, string e2)</code>
<div class="details">
<p>Explodes a string into array using custom brackets and
quote delimeters</p><p>Note: sqlExplode trims all returned parts</p><p>example:</p><p>parameters:
$str = "(age < 20 AND age > 18) AND name LIKE 'John Doe'"
$d   = ' '
$e1  = '('
$e2  = ')'</p><p>would return an array:
array(
'(age < 20 AND age > 18)',
'name',
'LIKE',
'John Doe'
);</p><dl>
<dt>Parameters:</dt>
<dd>str - String to be SQL exploded</dd>
<dd>d - Delimeter which explodes the string</dd>
<dd>e1 - First bracket, usually '('</dd>
<dd>e2 - Second bracket, usually ')'</dd>
</dl>
</div>

<hr>

<div class="location">/Doctrine/Query/Tokenizer.php at line 59</div>
<h3 id="tokenizeQuery()">tokenizeQuery</h3>
<code class="signature">public  array <strong>tokenizeQuery</strong>(string query)</code>
<div class="details">
<p>Splits the given dql query into an array where keys represent different
query part names and values are arrays splitted using sqlExplode method</p><p>example:</p><p>parameter:
$query = "SELECT u.* FROM User u WHERE u.name LIKE ?"
returns:
array(
'select' => array('u.*'),
'from'   => array('User', 'u'),
'where'  => array('u.name', 'LIKE', '?')
);</p><dl>
<dt>Parameters:</dt>
<dd>query - DQL query</dd>
<dt>Throws:</dt>
<dd>If some generic parsing error occurs</dd>
<dt>Returns:</dt>
<dd>An array containing the query string parts</dd>
</dl>
</div>

<hr>

<div class="header">
<h1>Doctrine</h1>
<ul>
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="../doctrine/package-summary.html">Namespace</a></li>
<li class="active">Class</li>
<li><a href="../doctrine/package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
</ul>
</div>

<div class="small_links">
<a href="../index.html" target="_top">Frames</a>
<a href="../doctrine/doctrine_query_tokenizer.html" target="_top">No frames</a>
</div>
<div class="small_links">
Summary: <a href="#summary_field">Field</a> | <a href="#summary_method">Method</a> | <a href="#summary_constr">Constr</a>
Detail: <a href="#detail_field">Field</a> | <a href="#detail_method">Method</a> | <a href="#summary_constr">Constr</a>
</div>
<hr>

<p id="footer">This document was generated by <a href="http://peej.github.com/phpdoctor/">PHPDoctor: The PHP Documentation Creator</a></p>

</body>

</html>